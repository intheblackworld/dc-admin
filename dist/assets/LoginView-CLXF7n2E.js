import{d as w,u as y,r as p,a as h,c as k,b as i,e as o,w as n,f as l,g as S,h as V,l as x,i as I,o as C,_ as B}from"./index-B3v5CdMq.js";const N={class:"login-container"},R={class:"login-card"},q=w({__name:"LoginView",setup(E){const f=I(),s=y(),m=p(null),r=p(!1),t=h({account_name:"",password:""}),g={account_name:{required:!0,message:"請輸入帳號",trigger:"blur"},password:{required:!0,message:"請輸入密碼",trigger:"blur"}},_=()=>{var u;(u=m.value)==null||u.validate(async a=>{if(!a){r.value=!0;try{const e=await x(t.account_name,t.password);e.status===0?(localStorage.setItem("token",e.data.token),localStorage.setItem("admin_id",e.data.admin_id.toString()),localStorage.setItem("account_name",e.data.account_name),localStorage.setItem("role_id",e.data.role_id.toString()),s.success("登入成功"),f.push("/")):s.error(e.message||"登入失敗")}catch(e){console.error("登入錯誤:",e),e instanceof Error?s.error(e.message||"登入時發生錯誤，請稍後再試"):s.error("登入時發生錯誤，請稍後再試")}finally{r.value=!1}}})};return(u,a)=>{const e=l("n-input"),c=l("n-form-item"),v=l("n-button"),b=l("n-form");return C(),k("div",N,[i("div",R,[a[3]||(a[3]=i("div",{class:"login-header"},[i("h1",null,"管理系統登入")],-1)),o(b,{ref_key:"formRef",ref:m,model:t,rules:g,"label-placement":"left","label-width":"80",size:"large"},{default:n(()=>[o(c,{path:"account_name",label:"帳號"},{default:n(()=>[o(e,{value:t.account_name,"onUpdate:value":a[0]||(a[0]=d=>t.account_name=d),placeholder:"請輸入帳號"},null,8,["value"])]),_:1}),o(c,{path:"password",label:"密碼"},{default:n(()=>[o(e,{value:t.password,"onUpdate:value":a[1]||(a[1]=d=>t.password=d),type:"password",placeholder:"請輸入密碼",onKeyup:S(_,["enter"])},null,8,["value"])]),_:1}),o(c,null,{default:n(()=>[o(v,{type:"primary",block:"",loading:r.value,disabled:r.value,onClick:_},{default:n(()=>a[2]||(a[2]=[V(" 登入 ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["model"])])])}}}),L=B(q,[["__scopeId","data-v-db9b3fce"]]);export{L as default};
