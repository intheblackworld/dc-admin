import{d as ne,u as te,r as f,j,a as q,c as $,b as o,e as n,w as t,f as r,k as le,S as ae,F as se,m as oe,h as d,t as x,n as ie,o as T,p as re,q as ue,s as S,_ as me}from"./index-B3v5CdMq.js";const de={class:"agent-level-page"},pe={class:"search-wrapper"},ce={class:"level-hierarchy"},ve={class:"hierarchy-chart"},fe={class:"level-info"},ge=["innerHTML"],_e={class:"level-stats"},be={class:"stat-item"},ke={class:"value"},ye={class:"stat-item"},Ce={class:"value"},xe={class:"info-text"},Le={class:"info-text"},we=ne({__name:"AgentLevelView",setup(he){const b=te(),p=f([{id:1,name:"VIP代理",agentCount:10,commission:30,parentId:null},{id:2,name:"高級代理",agentCount:25,commission:25,parentId:1},{id:3,name:"普通代理",agentCount:50,commission:20,parentId:2},{id:4,name:"初級代理",agentCount:120,commission:15,parentId:3}]),c=f(""),B=()=>{},z=j(()=>c.value?p.value.filter(a=>a.name.toLowerCase().includes(c.value.toLowerCase())):p.value),A=a=>{if(!c.value)return a;const e=new RegExp(c.value,"gi");return a.replace(e,i=>`<span class="highlight">${i}</span>`)},H=f(["1"]),I=(a,e=null)=>a.filter(i=>i.parentId===e).map(i=>({key:i.id.toString(),label:i.name,children:I(a,i.id)})),K=j(()=>I(p.value)),N=({option:a})=>{if(!c.value)return a.label;const e=a.label;return e.toLowerCase().includes(c.value.toLowerCase())?ie("span",{innerHTML:A(e)}):e},L=f(1),O=a=>{L.value=a;const e=p.value.find(i=>i.id===a);e&&(s.nickname=e.name,s.commission=e.commission,s.createTime="2024-04-10 10:30:45",s.loginTime="2024-04-15 14:25:38")},E=[{label:"https://agent.example.com/promo1",value:"promo1"},{label:"https://agent.example.com/promo2",value:"promo2"},{label:"https://agent.example.com/promo3",value:"promo3"}],w=f(null),s=q({promotionUrl:null,status:!0,createAgent:!1,memberLogin:!0,memberRegister:!0,nickname:"",commission:0,createTime:"",loginTime:""}),R=f(null),m=q({name:"",commission:0,minDeposit:0}),g=f(!1),D={name:{required:!0,message:"請輸入層級名稱",trigger:"blur"},commission:{required:!0,type:"number",message:"請輸入佣金比例",trigger:["blur","change"]},minDeposit:{required:!0,type:"number",message:"請輸入最低入金金額",trigger:["blur","change"]},nickname:{required:!0,message:"請輸入暱稱",trigger:"blur"},promotionUrl:{required:!0,message:"請選擇推廣網址",trigger:["blur","change"]}},P=a=>{s.nickname=a.name,s.commission=a.commission,s.createTime="2024-04-10 10:30:45",s.loginTime="2024-04-15 14:25:38",b.success("開始編輯層級")},G=a=>{const e=p.value.findIndex(i=>i.id===a.id);e>-1&&(p.value.splice(e,1),b.success("刪除成功"))},J=()=>{var a;(a=w.value)==null||a.restoreValidation(),Object.assign(s,{promotionUrl:null,status:!0,createAgent:!1,memberLogin:!0,memberRegister:!0,nickname:"",commission:0,createTime:"",loginTime:""})},Q=()=>{var a;(a=w.value)==null||a.validate(e=>{e||b.success("保存成功")})},W=()=>{var a;(a=R.value)==null||a.validate(e=>{if(!e){const i=Math.max(...p.value.map(_=>_.id))+1;p.value.push({id:i,name:m.name,commission:m.commission,agentCount:0,parentId:L.value}),b.success("新增成功"),g.value=!1,Object.assign(m,{name:"",commission:0,minDeposit:0})}})};return(a,e)=>{const i=r("n-icon"),_=r("n-input"),X=r("n-tree"),Y=r("n-divider"),k=r("n-grid-item"),v=r("n-button"),y=r("n-space"),M=r("n-grid"),h=r("n-card"),Z=r("n-select"),u=r("n-form-item"),C=r("n-switch"),U=r("n-input-number"),F=r("n-form"),ee=r("n-modal");return T(),$("div",de,[e[26]||(e[26]=o("div",{class:"page-header"},[o("h1",null,"代理層級"),o("div",{class:"page-tools"},[o("div",{class:"page-breadcrumb"},"代理管理>代理層級")])],-1)),n(M,{cols:24,"x-gap":24},{default:t(()=>[n(k,{span:12},{default:t(()=>[n(h,{title:"代理層級列表",class:"level-list-card"},{default:t(()=>[o("div",pe,[n(_,{value:c.value,"onUpdate:value":[e[0]||(e[0]=l=>c.value=l),B],placeholder:"請輸入關鍵字搜尋",clearable:""},{prefix:t(()=>[n(i,null,{default:t(()=>[n(le(ae))]),_:1})]),_:1},8,["value"])]),o("div",ce,[e[14]||(e[14]=o("h3",null,"代理層級架構圖",-1)),o("div",ve,[n(X,{"block-line":"",data:K.value,"default-expanded-keys":H.value,"render-label":N,selectable:""},null,8,["data","default-expanded-keys"])])]),n(Y),n(y,{vertical:""},{default:t(()=>[(T(!0),$(se,null,oe(z.value,l=>(T(),re(h,{key:l.id,class:ue(["level-card",{active:L.value===l.id}]),onClick:V=>O(l.id)},{default:t(()=>[n(M,{cols:24},{default:t(()=>[n(k,{span:16},{default:t(()=>[o("div",fe,[o("h3",{innerHTML:A(l.name)},null,8,ge),o("div",_e,[o("div",be,[e[15]||(e[15]=o("span",{class:"label"},"代理數量：",-1)),o("span",ke,x(l.agentCount),1)]),o("div",ye,[e[16]||(e[16]=o("span",{class:"label"},"佣金比例：",-1)),o("span",Ce,x(l.commission)+"%",1)])])])]),_:2},1024),n(k,{span:8,class:"level-actions"},{default:t(()=>[n(y,{justify:"end"},{default:t(()=>[n(v,{type:"primary",size:"small",onClick:S(V=>P(l),["stop"])},{default:t(()=>e[17]||(e[17]=[d(" 編輯 ")])),_:2},1032,["onClick"]),n(v,{type:"error",size:"small",onClick:S(V=>G(l),["stop"])},{default:t(()=>e[18]||(e[18]=[d(" 刪除 ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128)),n(v,{type:"primary",block:"",onClick:e[1]||(e[1]=l=>g.value=!0)},{default:t(()=>e[19]||(e[19]=[d(" 新增代理層級 ")])),_:1})]),_:1})]),_:1})]),_:1}),n(k,{span:12},{default:t(()=>[n(h,{title:"代理層級設定",class:"agent-setting-card"},{default:t(()=>[n(F,{ref_key:"formRef",ref:w,model:s,rules:D,"label-placement":"left","label-width":"120"},{default:t(()=>[n(u,{label:"選擇推廣網址",path:"promotionUrl"},{default:t(()=>[n(Z,{value:s.promotionUrl,"onUpdate:value":e[2]||(e[2]=l=>s.promotionUrl=l),options:E,placeholder:"請選擇推廣網址"},null,8,["value"])]),_:1}),n(u,{label:"狀態",path:"status"},{default:t(()=>[n(C,{value:s.status,"onUpdate:value":e[3]||(e[3]=l=>s.status=l)},null,8,["value"])]),_:1}),n(u,{label:"建立代理",path:"createAgent"},{default:t(()=>[n(C,{value:s.createAgent,"onUpdate:value":e[4]||(e[4]=l=>s.createAgent=l),disabled:""},null,8,["value"])]),_:1}),n(u,{label:"直屬會員登入",path:"memberLogin"},{default:t(()=>[n(C,{value:s.memberLogin,"onUpdate:value":e[5]||(e[5]=l=>s.memberLogin=l)},null,8,["value"])]),_:1}),n(u,{label:"會員註冊",path:"memberRegister"},{default:t(()=>[n(C,{value:s.memberRegister,"onUpdate:value":e[6]||(e[6]=l=>s.memberRegister=l)},null,8,["value"])]),_:1}),n(u,{label:"暱稱",path:"nickname"},{default:t(()=>[n(_,{value:s.nickname,"onUpdate:value":e[7]||(e[7]=l=>s.nickname=l),placeholder:"請輸入暱稱"},null,8,["value"])]),_:1}),n(u,{label:"代理佔成",path:"commission"},{default:t(()=>[n(U,{value:s.commission,"onUpdate:value":e[8]||(e[8]=l=>s.commission=l),min:0,max:100,precision:2,placeholder:"請輸入佣金比例"},{suffix:t(()=>e[20]||(e[20]=[d("%")])),_:1},8,["value"])]),_:1}),n(u,{label:"建立時間"},{default:t(()=>[o("div",xe,x(s.createTime||"尚未建立"),1)]),_:1}),n(u,{label:"登入時間"},{default:t(()=>[o("div",Le,x(s.loginTime||"尚未登入"),1)]),_:1}),n(u,null,{default:t(()=>[n(y,{justify:"end"},{default:t(()=>[n(v,{onClick:J},{default:t(()=>e[21]||(e[21]=[d("重置")])),_:1}),n(v,{type:"primary",onClick:Q},{default:t(()=>e[22]||(e[22]=[d("保存")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),n(ee,{show:g.value,"onUpdate:show":e[13]||(e[13]=l=>g.value=l),preset:"dialog",title:"新增代理層級"},{action:t(()=>[n(y,{justify:"end"},{default:t(()=>[n(v,{onClick:e[12]||(e[12]=l=>g.value=!1)},{default:t(()=>e[24]||(e[24]=[d("取消")])),_:1}),n(v,{type:"primary",onClick:W},{default:t(()=>e[25]||(e[25]=[d("確定")])),_:1})]),_:1})]),default:t(()=>[n(F,{ref_key:"addFormRef",ref:R,model:m,rules:D,"label-placement":"left","label-width":"100"},{default:t(()=>[n(u,{label:"層級名稱",path:"name"},{default:t(()=>[n(_,{value:m.name,"onUpdate:value":e[9]||(e[9]=l=>m.name=l),placeholder:"請輸入層級名稱"},null,8,["value"])]),_:1}),n(u,{label:"佣金比例",path:"commission"},{default:t(()=>[n(U,{value:m.commission,"onUpdate:value":e[10]||(e[10]=l=>m.commission=l),min:0,max:100,precision:2,placeholder:"請輸入佣金比例"},{suffix:t(()=>e[23]||(e[23]=[d("%")])),_:1},8,["value"])]),_:1}),n(u,{label:"最低入金",path:"minDeposit"},{default:t(()=>[n(U,{value:m.minDeposit,"onUpdate:value":e[11]||(e[11]=l=>m.minDeposit=l),min:0,precision:0,placeholder:"請輸入最低入金金額"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])])}}}),Te=me(we,[["__scopeId","data-v-ff73e46c"]]);export{Te as default};
