import{d as de,u as ce,r as X,a as re,v as le,x as fe,y as ve,c as pe,b as f,e as c,w as g,f as L,k as ie,B as ee,h as ue,n as N,N as _e,z as me,A as he,C as ge,o as $e,_ as be}from"./index-B3v5CdMq.js";function ye(V){return V&&V.__esModule&&Object.prototype.hasOwnProperty.call(V,"default")?V.default:V}var te={exports:{}},Me=te.exports,oe;function De(){return oe||(oe=1,function(V,C){(function(z,k){V.exports=k()})(Me,function(){var z=1e3,k=6e4,A=36e5,Y="millisecond",S="second",w="minute",i="hour",O="day",W="week",M="month",Q="quarter",I="year",U="date",x="Invalid Date",ae=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,ne=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,se={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(l){var e=["th","st","nd","rd"],t=l%100;return"["+l+(e[(t-20)%10]||e[t]||e[0])+"]"}},F=function(l,e,t){var r=String(l);return!r||r.length>=e?l:""+Array(e+1-r.length).join(t)+l},G={s:F,z:function(l){var e=-l.utcOffset(),t=Math.abs(e),r=Math.floor(t/60),n=t%60;return(e<=0?"+":"-")+F(r,2,"0")+":"+F(n,2,"0")},m:function l(e,t){if(e.date()<t.date())return-l(t,e);var r=12*(t.year()-e.year())+(t.month()-e.month()),n=e.clone().add(r,M),u=t-n<0,o=e.clone().add(r+(u?-1:1),M);return+(-(r+(t-n)/(u?n-o:o-n))||0)},a:function(l){return l<0?Math.ceil(l)||0:Math.floor(l)},p:function(l){return{M,y:I,w:W,d:O,D:U,h:i,m:w,s:S,ms:Y,Q}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(l){return l===void 0}},T="en",s={};s[T]=se;var a="$isDayjsObject",b=function(l){return l instanceof B||!(!l||!l[a])},_=function l(e,t,r){var n;if(!e)return T;if(typeof e=="string"){var u=e.toLowerCase();s[u]&&(n=u),t&&(s[u]=t,n=u);var o=e.split("-");if(!n&&o.length>1)return l(o[0])}else{var p=e.name;s[p]=e,n=p}return!r&&n&&(T=n),n||!r&&T},v=function(l,e){if(b(l))return l.clone();var t=typeof e=="object"?e:{};return t.date=l,t.args=arguments,new B(t)},d=G;d.l=_,d.i=b,d.w=function(l,e){return v(l,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var B=function(){function l(t){this.$L=_(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[a]=!0}var e=l.prototype;return e.parse=function(t){this.$d=function(r){var n=r.date,u=r.utc;if(n===null)return new Date(NaN);if(d.u(n))return new Date;if(n instanceof Date)return new Date(n);if(typeof n=="string"&&!/Z$/i.test(n)){var o=n.match(ae);if(o){var p=o[2]-1||0,m=(o[7]||"0").substring(0,3);return u?new Date(Date.UTC(o[1],p,o[3]||1,o[4]||0,o[5]||0,o[6]||0,m)):new Date(o[1],p,o[3]||1,o[4]||0,o[5]||0,o[6]||0,m)}}return new Date(n)}(t),this.init()},e.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},e.$utils=function(){return d},e.isValid=function(){return this.$d.toString()!==x},e.isSame=function(t,r){var n=v(t);return this.startOf(r)<=n&&n<=this.endOf(r)},e.isAfter=function(t,r){return v(t)<this.startOf(r)},e.isBefore=function(t,r){return this.endOf(r)<v(t)},e.$g=function(t,r,n){return d.u(t)?this[r]:this.set(n,t)},e.unix=function(){return Math.floor(this.valueOf()/1e3)},e.valueOf=function(){return this.$d.getTime()},e.startOf=function(t,r){var n=this,u=!!d.u(r)||r,o=d.p(t),p=function(H,y){var P=d.w(n.$u?Date.UTC(n.$y,y,H):new Date(n.$y,y,H),n);return u?P:P.endOf(O)},m=function(H,y){return d.w(n.toDate()[H].apply(n.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(y)),n)},h=this.$W,$=this.$M,D=this.$D,E="set"+(this.$u?"UTC":"");switch(o){case I:return u?p(1,0):p(31,11);case M:return u?p(1,$):p(0,$+1);case W:var j=this.$locale().weekStart||0,Z=(h<j?h+7:h)-j;return p(u?D-Z:D+(6-Z),$);case O:case U:return m(E+"Hours",0);case i:return m(E+"Minutes",1);case w:return m(E+"Seconds",2);case S:return m(E+"Milliseconds",3);default:return this.clone()}},e.endOf=function(t){return this.startOf(t,!1)},e.$set=function(t,r){var n,u=d.p(t),o="set"+(this.$u?"UTC":""),p=(n={},n[O]=o+"Date",n[U]=o+"Date",n[M]=o+"Month",n[I]=o+"FullYear",n[i]=o+"Hours",n[w]=o+"Minutes",n[S]=o+"Seconds",n[Y]=o+"Milliseconds",n)[u],m=u===O?this.$D+(r-this.$W):r;if(u===M||u===I){var h=this.clone().set(U,1);h.$d[p](m),h.init(),this.$d=h.set(U,Math.min(this.$D,h.daysInMonth())).$d}else p&&this.$d[p](m);return this.init(),this},e.set=function(t,r){return this.clone().$set(t,r)},e.get=function(t){return this[d.p(t)]()},e.add=function(t,r){var n,u=this;t=Number(t);var o=d.p(r),p=function($){var D=v(u);return d.w(D.date(D.date()+Math.round($*t)),u)};if(o===M)return this.set(M,this.$M+t);if(o===I)return this.set(I,this.$y+t);if(o===O)return p(1);if(o===W)return p(7);var m=(n={},n[w]=k,n[i]=A,n[S]=z,n)[o]||1,h=this.$d.getTime()+t*m;return d.w(h,this)},e.subtract=function(t,r){return this.add(-1*t,r)},e.format=function(t){var r=this,n=this.$locale();if(!this.isValid())return n.invalidDate||x;var u=t||"YYYY-MM-DDTHH:mm:ssZ",o=d.z(this),p=this.$H,m=this.$m,h=this.$M,$=n.weekdays,D=n.months,E=n.meridiem,j=function(y,P,q,K){return y&&(y[P]||y(r,u))||q[P].slice(0,K)},Z=function(y){return d.s(p%12||12,y,"0")},H=E||function(y,P,q){var K=y<12?"AM":"PM";return q?K.toLowerCase():K};return u.replace(ne,function(y,P){return P||function(q){switch(q){case"YY":return String(r.$y).slice(-2);case"YYYY":return d.s(r.$y,4,"0");case"M":return h+1;case"MM":return d.s(h+1,2,"0");case"MMM":return j(n.monthsShort,h,D,3);case"MMMM":return j(D,h);case"D":return r.$D;case"DD":return d.s(r.$D,2,"0");case"d":return String(r.$W);case"dd":return j(n.weekdaysMin,r.$W,$,2);case"ddd":return j(n.weekdaysShort,r.$W,$,3);case"dddd":return $[r.$W];case"H":return String(p);case"HH":return d.s(p,2,"0");case"h":return Z(1);case"hh":return Z(2);case"a":return H(p,m,!0);case"A":return H(p,m,!1);case"m":return String(m);case"mm":return d.s(m,2,"0");case"s":return String(r.$s);case"ss":return d.s(r.$s,2,"0");case"SSS":return d.s(r.$ms,3,"0");case"Z":return o}return null}(y)||o.replace(":","")})},e.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},e.diff=function(t,r,n){var u,o=this,p=d.p(r),m=v(t),h=(m.utcOffset()-this.utcOffset())*k,$=this-m,D=function(){return d.m(o,m)};switch(p){case I:u=D()/12;break;case M:u=D();break;case Q:u=D()/3;break;case W:u=($-h)/6048e5;break;case O:u=($-h)/864e5;break;case i:u=$/A;break;case w:u=$/k;break;case S:u=$/z;break;default:u=$}return n?u:d.a(u)},e.daysInMonth=function(){return this.endOf(M).$D},e.$locale=function(){return s[this.$L]},e.locale=function(t,r){if(!t)return this.$L;var n=this.clone(),u=_(t,r,!0);return u&&(n.$L=u),n},e.clone=function(){return d.w(this.$d,this)},e.toDate=function(){return new Date(this.valueOf())},e.toJSON=function(){return this.isValid()?this.toISOString():null},e.toISOString=function(){return this.$d.toISOString()},e.toString=function(){return this.$d.toUTCString()},l}(),J=B.prototype;return v.prototype=J,[["$ms",Y],["$s",S],["$m",w],["$H",i],["$W",O],["$M",M],["$y",I],["$D",U]].forEach(function(l){J[l[1]]=function(e){return this.$g(e,l[0],l[1])}}),v.extend=function(l,e){return l.$i||(l(e,B,v),l.$i=!0),v},v.locale=_,v.isDayjs=b,v.unix=function(l){return v(1e3*l)},v.en=s[T],v.Ls=s,v.p={},v})}(te)),te.exports}var Se=De();const R=ye(Se),we={class:"member-account-page"},ke={class:"search-item"},Ye={class:"search-item"},Oe={class:"search-item"},Ie={class:"search-item"},xe={class:"search-item"},Ce={class:"search-item"},Ue={class:"search-item"},Ve={class:"search-item"},Pe={class:"search-item"},ze={class:"search-buttons"},Te={class:"search-item"},je={class:"search-item"},He={class:"search-item"},Le=de({__name:"MemberAccountView",setup(V){const C=ce(),z=X(!1),k=X([]),A=re({}),Y=re({page:1,pageSize:20,itemCount:0,showSizePicker:!0,pageSizes:[10,20,30,50],onChange:s=>{Y.page=s,x()},onUpdatePageSize:s=>{Y.pageSize=s,Y.page=1,i.page_size=s,x()}}),S=X(null),w=X(null),i=re({page:1,page_size:20,account_status:null,account_name:"",nick_name:"",phone_num:"",id_card_number:"",real_name:"",agent_id:"",vip_level:null,risk_level:null,register_time_start:"",register_time_end:"",last_login_at_start:"",last_login_at_end:""});le(S,s=>{s?(i.register_time_start=R(s[0]).format("YYYY-MM-DD"),i.register_time_end=R(s[1]).format("YYYY-MM-DD")):(i.register_time_start="",i.register_time_end="")}),le(w,s=>{s?(i.last_login_at_start=R(s[0]).format("YYYY-MM-DD"),i.last_login_at_end=R(s[1]).format("YYYY-MM-DD")):(i.last_login_at_start="",i.last_login_at_end="")});const O=[{label:"正常",value:"1"},{label:"封號",value:"2"}],W=[{label:"VIP0",value:"0"},{label:"VIP1",value:"1"},{label:"VIP2",value:"2"},{label:"VIP3",value:"3"},{label:"VIP4",value:"4"},{label:"VIP5",value:"5"},{label:"VIP6",value:"6"},{label:"VIP7",value:"7"},{label:"VIP8",value:"8"},{label:"VIP9",value:"9"},{label:"VIP10",value:"10"}],M=[{label:"0",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"}],Q=[{label:"10條/頁",value:10},{label:"20條/頁",value:20},{label:"30條/頁",value:30},{label:"50條/頁",value:50}],I=[{title:"UID",key:"uid",width:100},{title:"帳號名稱",key:"account_name",width:120},{title:"暱稱",key:"nick_name",width:120},{title:"手機號碼",key:"phone_num",width:120},{title:"身份證號碼",key:"id_card_number",width:150},{title:"直屬上級代理",key:"agent_id",width:120},{title:"VIP等級",key:"vip_level",width:100,render(s){return N(_e,{type:"success",size:"small"},{default:()=>`VIP${s.vip_level}`})}},{title:"風控等級",key:"risk_level",width:100},{title:"註冊時間",key:"register_time",width:180,render(s){return U(s.register_time)}},{title:"最後登入時間",key:"last_login_at",width:180,render(s){return U(s.last_login_at)}},{title:"會員狀態",key:"account_status",width:120,render(s){const a=s.account_status==="1"?"正常":"封號",b=s.account_status==="1"?"#18a058":"#d03050";return N("div",{style:{display:"flex",alignItems:"center"}},[N(me,{value:s.account_status==="1",loading:A[s.uid]===!0,onUpdateValue:_=>{ae(s.uid,_?"1":"2")},railStyle:()=>({background:s.account_status==="1"?"#18a058":"#d03050"})}),N("span",{style:{marginLeft:"8px",color:b}},a)])}},{title:"操作",key:"actions",width:120,fixed:"right",render(s){return N(he,{justify:"center",align:"center"},{default:()=>[N(ee,{size:"small",type:"primary",ghost:!0,onClick:()=>se(s)},{default:()=>"詳情"}),N(ee,{size:"small",type:"info",ghost:!0,onClick:()=>F(s)},{default:()=>"發信"})]})}}];function U(s){return s?R(s).format("YYYY-MM-DD HH:mm:ss"):"-"}async function x(){z.value=!0;try{const s={...i},a=await fe(s);a.status===0?(k.value=a.data.list,Y.itemCount=a.data.total):C.error(a.message||"獲取會員列表失敗")}catch(s){console.error("加載會員列表失敗:",s),C.error("獲取會員列表時發生錯誤")}finally{z.value=!1}}ve(()=>{x()});async function ae(s,a){console.log(`切換會員狀態: UID=${s}, 新狀態=${a}`),A[s]=!0;try{const b=await ge(s,a);if(b.status===0){C.success(a==="1"?"啟用成功":"封號成功");const _=k.value.findIndex(v=>v.uid===s);_!==-1?k.value[_].account_status=a:x()}else C.error(b.message||"操作失敗"),x()}catch(b){console.error("切換會員狀態發生錯誤:",b),C.error("操作時發生錯誤"),x()}finally{A[s]=!1}}const ne=s=>s.account_status==="2"?"inactive-row":"";function se(s){C.info(`查看會員詳情：${s.account_name}`)}function F(s){C.info(`向會員 ${s.account_name} 發送站內信`)}const G=()=>{Y.page=1,i.page=1,x()},T=()=>{Object.keys(i).forEach(s=>{s!=="page"&&s!=="page_size"&&(i[s]=typeof i[s]=="string"?"":null)}),S.value=null,w.value=null,C.info("已清除搜尋條件"),G()};return(s,a)=>{const b=L("n-select"),_=L("n-grid-item"),v=L("n-input"),d=L("n-date-picker"),B=L("n-grid"),J=L("n-card"),l=L("n-data-table");return $e(),pe("div",we,[a[26]||(a[26]=f("div",{class:"page-header"},[f("h1",null,"會員帳號"),f("div",{class:"page-tools"},[f("div",{class:"page-breadcrumb"},"會員管理>會員帳號")])],-1)),c(J,{class:"search-area"},{default:g(()=>[c(B,{cols:24,"x-gap":12,"y-gap":16},{default:g(()=>[c(_,{span:4},{default:g(()=>[f("div",ke,[a[12]||(a[12]=f("div",{class:"label"},"帳號狀態",-1)),c(b,{value:i.account_status,"onUpdate:value":a[0]||(a[0]=e=>i.account_status=e),options:O,placeholder:"請選擇",clearable:""},null,8,["value"])])]),_:1}),c(_,{span:4},{default:g(()=>[f("div",Ye,[a[13]||(a[13]=f("div",{class:"label"},"帳號名稱",-1)),c(v,{value:i.account_name,"onUpdate:value":a[1]||(a[1]=e=>i.account_name=e),placeholder:"請輸入帳號名稱",clearable:""},null,8,["value"])])]),_:1}),c(_,{span:4},{default:g(()=>[f("div",Oe,[a[14]||(a[14]=f("div",{class:"label"},"暱稱",-1)),c(v,{value:i.nick_name,"onUpdate:value":a[2]||(a[2]=e=>i.nick_name=e),placeholder:"請輸入暱稱",clearable:""},null,8,["value"])])]),_:1}),c(_,{span:4},{default:g(()=>[f("div",Ie,[a[15]||(a[15]=f("div",{class:"label"},"手機號碼",-1)),c(v,{value:i.phone_num,"onUpdate:value":a[3]||(a[3]=e=>i.phone_num=e),placeholder:"請輸入手機號碼",clearable:""},null,8,["value"])])]),_:1}),c(_,{span:4},{default:g(()=>[f("div",xe,[a[16]||(a[16]=f("div",{class:"label"},"身份證號碼",-1)),c(v,{value:i.id_card_number,"onUpdate:value":a[4]||(a[4]=e=>i.id_card_number=e),placeholder:"請輸入身份證號碼",clearable:""},null,8,["value"])])]),_:1}),c(_,{span:4},{default:g(()=>[f("div",Ce,[a[17]||(a[17]=f("div",{class:"label"},"真實姓名",-1)),c(v,{value:i.real_name,"onUpdate:value":a[5]||(a[5]=e=>i.real_name=e),placeholder:"請輸入真實姓名",clearable:""},null,8,["value"])])]),_:1}),c(_,{span:4},{default:g(()=>[f("div",Ue,[a[18]||(a[18]=f("div",{class:"label"},"直屬上級代理UID",-1)),c(v,{value:i.agent_id,"onUpdate:value":a[6]||(a[6]=e=>i.agent_id=e),placeholder:"請輸入代理UID",clearable:""},null,8,["value"])])]),_:1}),c(_,{span:4},{default:g(()=>[f("div",Ve,[a[19]||(a[19]=f("div",{class:"label"},"VIP等級",-1)),c(b,{value:i.vip_level,"onUpdate:value":a[7]||(a[7]=e=>i.vip_level=e),options:W,placeholder:"請選擇",clearable:""},null,8,["value"])])]),_:1}),c(_,{span:4},{default:g(()=>[f("div",Pe,[a[20]||(a[20]=f("div",{class:"label"},"風控等級",-1)),c(b,{value:i.risk_level,"onUpdate:value":a[8]||(a[8]=e=>i.risk_level=e),options:M,placeholder:"請選擇",clearable:""},null,8,["value"])])]),_:1}),c(_,{span:12},{default:g(()=>[f("div",ze,[c(ie(ee),{type:"primary",onClick:G},{default:g(()=>a[21]||(a[21]=[ue("搜尋")])),_:1}),c(ie(ee),{onClick:T},{default:g(()=>a[22]||(a[22]=[ue("清除查詢")])),_:1})])]),_:1}),c(_,{span:8},{default:g(()=>[f("div",Te,[a[23]||(a[23]=f("div",{class:"label"},"註冊時間",-1)),c(d,{value:S.value,"onUpdate:value":a[9]||(a[9]=e=>S.value=e),type:"daterange",clearable:"",style:{width:"100%"}},null,8,["value"])])]),_:1}),c(_,{span:8},{default:g(()=>[f("div",je,[a[24]||(a[24]=f("div",{class:"label"},"最後登入時間",-1)),c(d,{value:w.value,"onUpdate:value":a[10]||(a[10]=e=>w.value=e),type:"daterange",clearable:"",style:{width:"100%"}},null,8,["value"])])]),_:1}),c(_,{span:8},{default:g(()=>[f("div",He,[a[25]||(a[25]=f("div",{class:"label"},"每頁顯示",-1)),c(b,{value:i.page_size,"onUpdate:value":a[11]||(a[11]=e=>i.page_size=e),options:Q,placeholder:"請選擇每頁數量"},null,8,["value"])])]),_:1})]),_:1})]),_:1}),c(J,{class:"data-table-area"},{default:g(()=>[c(l,{columns:I,data:k.value,pagination:Y,bordered:!1,loading:z.value,size:"small","row-class-name":ne,stripe:""},null,8,["data","pagination","loading"])]),_:1})])}}}),Ae=be(Le,[["__scopeId","data-v-bc803068"]]);export{Ae as default};
